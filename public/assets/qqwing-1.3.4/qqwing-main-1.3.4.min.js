/*!
 * qqwing - Sudoku solver and generator
 * Copyright (C) 2014 Stephen Ostermiller
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along
 * with this program; if not, write to the Free Software Foundation, Inc.,
 * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */
;var qqwing=function(){var ai=function(aj){return aj%qqwing.ROW_COL_SEC_SIZE};var M=function(aj){return Math.floor(aj/qqwing.ROW_COL_SEC_SIZE)};var P=function(aj){return Math.floor(aj/qqwing.SEC_GROUP_SIZE)*qqwing.SEC_GROUP_SIZE+Math.floor(ai(aj)/qqwing.GRID_SIZE)*qqwing.GRID_SIZE};var p=function(aj){return Math.floor(aj/qqwing.SEC_GROUP_SIZE)*qqwing.GRID_SIZE+Math.floor(ai(aj)/qqwing.GRID_SIZE)};var j=function(aj){return qqwing.ROW_COL_SEC_SIZE*aj};var Z=function(aj){return aj};var W=function(aj){return(aj%qqwing.GRID_SIZE*qqwing.GRID_SIZE)+Math.floor(aj/qqwing.GRID_SIZE)*qqwing.SEC_GROUP_SIZE};var ac=function(ak,aj){return ak+(qqwing.ROW_COL_SEC_SIZE*aj)};var k=function(ak,aj){return(ak*qqwing.ROW_COL_SEC_SIZE)+aj};var E=function(aj,ak){return W(aj)+Math.floor(ak/qqwing.GRID_SIZE)*qqwing.ROW_COL_SEC_SIZE+(ak%qqwing.GRID_SIZE)};var N=function(aj){if((typeof console!="undefined")&&console.log){console.log(aj)}};var Y=function(aj){if((typeof process!="undefined")&&process.stdout&&process.stdout.write){process.stdout.write(aj)}else{N(aj)}};var B=new Array(qqwing.BOARD_SIZE);var c=new Array(qqwing.BOARD_SIZE);var m=new Array(qqwing.BOARD_SIZE);var x=new Array(qqwing.POSSIBILITY_SIZE);var af=new Array(qqwing.BOARD_SIZE);for(var ab=0;ab<qqwing.BOARD_SIZE;ab++){af[ab]=ab}var a=new Array(qqwing.ROW_COL_SEC_SIZE);for(var ab=0;ab<qqwing.ROW_COL_SEC_SIZE;ab++){a[ab]=ab}var l=false;var ag=false;var r=[];var J=[];var U=qqwing.PrintStyle.READABLE;var z=0;var Q=function(){for(var am=0;am<qqwing.BOARD_SIZE;am++){c[am]=0}for(var am=0;am<qqwing.BOARD_SIZE;am++){m[am]=0}for(var am=0;am<qqwing.POSSIBILITY_SIZE;am++){x[am]=0}r=[];J=[];var al=1;for(var aj=0;aj<qqwing.BOARD_SIZE;aj++){if(B[aj]>0){var ak=B[aj]-1;var an=ac(ak,aj);var ao=B[aj];if(x[an]!=0){return false}n.call(this,aj,al,ao);if(ag||l){F.call(this,new this.LogItem(al,qqwing.LogType.GIVEN,ao,aj))}}}return true};var D=function(aj){if(v.call(this,aj)){return true}if(g.call(this,aj)){return true}if(w.call(this,aj)){return true}if(T.call(this,aj)){return true}if(ah.call(this,aj)){return true}if(q.call(this,aj)){return true}if(X.call(this,aj)){return true}if(H.call(this,aj)){return true}if(K.call(this,aj)){return true}if(f.call(this,aj)){return true}if(C.call(this,aj)){return true}if(V.call(this,aj)){return true}return false};var v=function(al){for(var aj=0;aj<qqwing.BOARD_SIZE;aj++){if(c[aj]==0){var ao=0;var am=0;for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){var an=ac(ak,aj);if(x[an]==0){ao++;am=ak+1}}if(ao==1){n.call(this,aj,al,am);if(ag||l){F.call(this,new this.LogItem(al,qqwing.LogType.SINGLE,am,aj))}return true}}}return false};var w=function(ap){for(var ar=0;ar<qqwing.ROW_COL_SEC_SIZE;ar++){for(var aq=0;aq<qqwing.ROW_COL_SEC_SIZE;aq++){var am=0;var ao=0;for(var aj=0;aj<qqwing.ROW_COL_SEC_SIZE;aj++){var al=(ar*qqwing.ROW_COL_SEC_SIZE)+aj;var ak=ac(aq,al);if(x[ak]==0){am++;ao=al}}if(am==1){var an=aq+1;if(ag||l){F.call(this,new this.LogItem(ap,qqwing.LogType.HIDDEN_SINGLE_ROW,an,ao))}n.call(this,ao,ap,an);return true}}}return false};var T=function(ap){for(var aj=0;aj<qqwing.ROW_COL_SEC_SIZE;aj++){for(var aq=0;aq<qqwing.ROW_COL_SEC_SIZE;aq++){var am=0;var ao=0;for(var ar=0;ar<qqwing.ROW_COL_SEC_SIZE;ar++){var al=k(ar,aj);var ak=ac(aq,al);if(x[ak]==0){am++;ao=al}}if(am==1){var an=aq+1;if(ag||l){F.call(this,new this.LogItem(ap,qqwing.LogType.HIDDEN_SINGLE_COLUMN,an,ao))}n.call(this,ao,ap,an);return true}}}return false};var g=function(at){for(var ap=0;ap<qqwing.ROW_COL_SEC_SIZE;ap++){var al=W(ap);for(var au=0;au<qqwing.ROW_COL_SEC_SIZE;au++){var ao=0;var ar=0;for(var am=0;am<qqwing.GRID_SIZE;am++){for(var ak=0;ak<qqwing.GRID_SIZE;ak++){var an=al+am+qqwing.ROW_COL_SEC_SIZE*ak;var aj=ac(au,an);if(x[aj]==0){ao++;ar=an}}}if(ao==1){var aq=au+1;if(ag||l){F.call(this,new this.LogItem(at,qqwing.LogType.HIDDEN_SINGLE_SECTION,aq,ar))}n.call(this,ar,at,aq);return true}}}return false};var A=function(al,aq){var an=0;var aj=d.call(this);for(var am=0;am<qqwing.ROW_COL_SEC_SIZE;am++){var ak=a[am];var ao=ac(ak,aj);if(x[ao]==0){if(an==aq){var ap=ak+1;if(ag||l){F.call(this,new this.LogItem(al,qqwing.LogType.GUESS,ap,aj))}n.call(this,aj,al,ap);return true}an++}}return false};var S=function(){for(var aj=0;aj<qqwing.BOARD_SIZE;aj++){if(c[aj]==0){var am=0;for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){var al=ac(ak,aj);if(x[al]==0){am++}}if(am==0){return true}}}return false};var O=function(aj){if(ag||l){F.call(this,new this.LogItem(aj,qqwing.LogType.ROLLBACK))}for(var ak=0;ak<qqwing.BOARD_SIZE;ak++){if(m[ak]==aj){m[ak]=0;c[ak]=0}}for(var ak=0;ak<qqwing.POSSIBILITY_SIZE;ak++){if(x[ak]==aj){x[ak]=0}}while(J.length>0&&J[J.length-1]==aj){J.pop()}};var q=function(aw){for(var ax=0;ax<qqwing.ROW_COL_SEC_SIZE;ax++){for(var au=0;au<qqwing.ROW_COL_SEC_SIZE;au++){var ap=W(au);var aj=true;var ak=-1;for(var ao=0;ao<qqwing.GRID_SIZE;ao++){for(var aq=0;aq<qqwing.GRID_SIZE;aq++){var av=ap+aq+(qqwing.ROW_COL_SEC_SIZE*ao);var an=ac(ax,av);if(x[an]==0){if(ak==-1||ak==ao){ak=ao}else{aj=false}}}}if(aj&&ak!=-1){var al=false;var ay=M(ap)+ak;var am=j(ay);for(var aq=0;aq<qqwing.ROW_COL_SEC_SIZE;aq++){var ar=am+aq;var at=p(ar);var an=ac(ax,ar);if(au!=at&&x[an]==0){x[an]=aw;al=true}}if(al){if(ag||l){F.call(this,new this.LogItem(aw,qqwing.LogType.POINTING_PAIR_TRIPLE_ROW,ax+1,am))}return true}}}}return false};var H=function(ax){for(var ay=0;ay<qqwing.ROW_COL_SEC_SIZE;ay++){for(var aA=0;aA<qqwing.ROW_COL_SEC_SIZE;aA++){var al=j(aA);var at=true;var av=-1;for(var ap=0;ap<qqwing.GRID_SIZE;ap++){for(var an=0;an<qqwing.GRID_SIZE;an++){var ak=ap*qqwing.GRID_SIZE+an;var aq=k(aA,ak);var am=ac(ay,aq);if(x[am]==0){if(av==-1||av==ap){av=ap}else{at=false}}}}if(at&&av!=-1){var aj=false;var ak=qqwing.GRID_SIZE*av;var ao=P(k(aA,ak));var au=M(ao);var az=ai(ao);for(var ap=0;ap<qqwing.GRID_SIZE;ap++){for(var an=0;an<qqwing.GRID_SIZE;an++){var aw=au+ap;var ar=az+an;var aq=k(aw,ar);var am=ac(ay,aq);if(aA!=aw&&x[am]==0){x[am]=ax;aj=true}}}if(aj){if(ag||l){F.call(this,new this.LogItem(ax,qqwing.LogType.ROW_BOX,ay+1,al))}return true}}}}return false};var K=function(ax){for(var ay=0;ay<qqwing.ROW_COL_SEC_SIZE;ay++){for(var aA=0;aA<qqwing.ROW_COL_SEC_SIZE;aA++){var al=j(aA);var at=true;var av=-1;for(var ap=0;ap<qqwing.GRID_SIZE;ap++){for(var an=0;an<qqwing.GRID_SIZE;an++){var ak=ap*qqwing.GRID_SIZE+an;var aq=k(aA,ak);var am=ac(ay,aq);if(x[am]==0){if(av==-1||av==ap){av=ap}else{at=false}}}}if(at&&av!=-1){var aj=false;var ak=qqwing.GRID_SIZE*av;var ao=P(k(aA,ak));var au=M(ao);var az=ai(ao);for(var ap=0;ap<qqwing.GRID_SIZE;ap++){for(var an=0;an<qqwing.GRID_SIZE;an++){var aw=au+ap;var ar=az+an;var aq=k(aw,ar);var am=ac(ay,aq);if(aA!=aw&&x[am]==0){x[am]=ax;aj=true}}}if(aj){if(ag||l){F.call(this,new this.LogItem(ax,qqwing.LogType.ROW_BOX,ay+1,al))}return true}}}}return false};var X=function(ax){for(var ay=0;ay<qqwing.ROW_COL_SEC_SIZE;ay++){for(var av=0;av<qqwing.ROW_COL_SEC_SIZE;av++){var aq=W(av);var al=true;var ao=-1;for(var ar=0;ar<qqwing.GRID_SIZE;ar++){for(var an=0;an<qqwing.GRID_SIZE;an++){var aw=aq+ar+(qqwing.ROW_COL_SEC_SIZE*an);var am=ac(ay,aw);if(x[am]==0){if(ao==-1||ao==ar){ao=ar}else{al=false}}}}if(al&&ao!=-1){var ak=false;var aj=ai(aq)+ao;var ap=Z(aj);for(var ar=0;ar<qqwing.ROW_COL_SEC_SIZE;ar++){var at=ap+(qqwing.ROW_COL_SEC_SIZE*ar);var au=p(at);var am=ac(ay,at);if(av!=au&&x[am]==0){x[am]=ax;ak=true}}if(ak){if(ag||l){F.call(this,new this.LogItem(ax,qqwing.LogType.POINTING_PAIR_TRIPLE_COLUMN,ay+1,ap))}return true}}}}return false};var f=function(aA){for(var am=0;am<qqwing.ROW_COL_SEC_SIZE;am++){for(var an=0;an<qqwing.ROW_COL_SEC_SIZE;an++){var au=-1;var at=-1;var ao=0;for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){var aC=k(am,ak);var aj=ac(an,aC);if(x[aj]==0){if(au==-1||au==ak){au=ak}else{if(at==-1||at==ak){at=ak}}ao++}}if(ao==2){for(var aB=an+1;aB<qqwing.ROW_COL_SEC_SIZE;aB++){var ar=-1;var aq=-1;var ap=0;for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){var aC=k(am,ak);var aj=ac(aB,aC);if(x[aj]==0){if(ar==-1||ar==ak){ar=ak}else{if(aq==-1||aq==ak){aq=ak}}ap++}}if(ap==2&&au==ar&&at==aq){var al=false;for(var az=0;az<qqwing.ROW_COL_SEC_SIZE;az++){if(az!=an&&az!=aB){var ay=k(am,au);var aw=k(am,at);var ax=ac(az,ay);var av=ac(az,aw);if(x[ax]==0){x[ax]=aA;al=true}if(x[av]==0){x[av]=aA;al=true}}}if(al){if(ag||l){F.call(this,new this.LogItem(aA,qqwing.LogType.HIDDEN_PAIR_ROW,an+1,k(am,au)))}return true}}}}}}return false};var C=function(aA){for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){for(var an=0;an<qqwing.ROW_COL_SEC_SIZE;an++){var ay=-1;var av=-1;var ao=0;for(var am=0;am<qqwing.ROW_COL_SEC_SIZE;am++){var aC=k(am,ak);var aj=ac(an,aC);if(x[aj]==0){if(ay==-1||ay==am){ay=am}else{if(av==-1||av==am){av=am}}ao++}}if(ao==2){for(var aB=an+1;aB<qqwing.ROW_COL_SEC_SIZE;aB++){var ar=-1;var aq=-1;var ap=0;for(var am=0;am<qqwing.ROW_COL_SEC_SIZE;am++){var aC=k(am,ak);var aj=ac(aB,aC);if(x[aj]==0){if(ar==-1||ar==am){ar=am}else{if(aq==-1||aq==am){aq=am}}ap++}}if(ap==2&&ay==ar&&av==aq){var al=false;for(var az=0;az<qqwing.ROW_COL_SEC_SIZE;az++){if(az!=an&&az!=aB){var ax=k(ay,ak);var au=k(av,ak);var aw=ac(az,ax);var at=ac(az,au);if(x[aw]==0){x[aw]=aA;al=true}if(x[at]==0){x[at]=aA;al=true}}}if(al){if(ag||l){F.call(this,new this.LogItem(aA,qqwing.LogType.HIDDEN_PAIR_COLUMN,an+1,k(ay,ak)))}return true}}}}}}return false};var V=function(aA){for(var ap=0;ap<qqwing.ROW_COL_SEC_SIZE;ap++){for(var aq=0;aq<qqwing.ROW_COL_SEC_SIZE;aq++){var ao=-1;var an=-1;var ar=0;for(var ay=0;ay<qqwing.ROW_COL_SEC_SIZE;ay++){var aC=E(ap,ay);var aj=ac(aq,aC);if(x[aj]==0){if(ao==-1||ao==ay){ao=ay}else{if(an==-1||an==ay){an=ay}}ar++}}if(ar==2){for(var aB=aq+1;aB<qqwing.ROW_COL_SEC_SIZE;aB++){var al=-1;var ak=-1;var at=0;for(var ay=0;ay<qqwing.ROW_COL_SEC_SIZE;ay++){var aC=E(ap,ay);var aj=ac(aB,aC);if(x[aj]==0){if(al==-1||al==ay){al=ay}else{if(ak==-1||ak==ay){ak=ay}}at++}}if(at==2&&ao==al&&an==ak){var am=false;for(var az=0;az<qqwing.ROW_COL_SEC_SIZE;az++){if(az!=aq&&az!=aB){var ax=E(ap,ao);var av=E(ap,an);var aw=ac(az,ax);var au=ac(az,av);if(x[aw]==0){x[aw]=aA;am=true}if(x[au]==0){x[au]=aA;am=true}}}if(am){if(ag||l){F.call(this,new this.LogItem(aA,qqwing.LogType.HIDDEN_PAIR_SECTION,aq+1,E(ap,ao)))}return true}}}}}}return false};var n=function(aq,aw,au){if(c[aq]!=0){throw ("Marking position that already has been marked.")}if(m[aq]!=0){throw ("Marking position that was marked another round.")}var ax=au-1;c[aq]=au;var ay=ac(ax,aq);if(x[ay]!=0){throw ("Marking impossible position.")}m[aq]=aw;var ak=M(aq)*qqwing.ROW_COL_SEC_SIZE;for(var aj=0;aj<qqwing.ROW_COL_SEC_SIZE;aj++){var ar=ak+aj;var al=ac(ax,ar);if(x[al]==0){x[al]=aw}}var ap=ai(aq);for(var ao=0;ao<qqwing.ROW_COL_SEC_SIZE;ao++){var at=ap+(qqwing.ROW_COL_SEC_SIZE*ao);var al=ac(ax,at);if(x[al]==0){x[al]=aw}}var an=P(aq);for(var ao=0;ao<qqwing.GRID_SIZE;ao++){for(var am=0;am<qqwing.GRID_SIZE;am++){var av=an+ao+(qqwing.ROW_COL_SEC_SIZE*am);var al=ac(ax,av);if(x[al]==0){x[al]=aw}}}for(var ax=0;ax<qqwing.ROW_COL_SEC_SIZE;ax++){var al=ac(ax,aq);if(x[al]==0){x[al]=aw}}};var d=function(){var ap=10;var ao=0;for(var al=0;al<qqwing.BOARD_SIZE;al++){var aj=af[al];if(c[aj]==0){var an=0;for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){var am=ac(ak,aj);if(x[am]==0){an++}}if(an<ap){ap=an;ao=aj}}}return ao};var ah=function(ax){for(var au=0;au<qqwing.BOARD_SIZE;au++){var ak=h(au);if(ak==2){var ay=M(au);var ao=ai(au);var aw=P(au);for(var an=au;an<qqwing.BOARD_SIZE;an++){if(au!=an){var at=h(an);if(at==2&&R(au,an)){if(ay==M(an)){var am=false;for(var aj=0;aj<qqwing.ROW_COL_SEC_SIZE;aj++){var al=k(ay,aj);if(al!=au&&al!=an&&L(au,al,ax)){am=true}}if(am){if(ag||l){F.call(this,new this.LogItem(ax,qqwing.LogType.NAKED_PAIR_ROW,0,au))}return true}}if(ao==ai(an)){var am=false;for(var av=0;av<qqwing.ROW_COL_SEC_SIZE;av++){var al=k(av,ao);if(al!=au&&al!=an&&L(au,al,ax)){am=true}}if(am){if(ag||l){F.call(this,new this.LogItem(ax,qqwing.LogType.NAKED_PAIR_COLUMN,0,au))}return true}}if(aw==P(an)){var am=false;var ar=P(au);for(var aq=0;aq<qqwing.GRID_SIZE;aq++){for(var ap=0;ap<qqwing.GRID_SIZE;ap++){var al=ar+aq+(qqwing.ROW_COL_SEC_SIZE*ap);if(al!=au&&al!=an&&L(au,al,ax)){am=true}}}if(am){if(ag||l){F.call(this,new this.LogItem(ax,qqwing.LogType.NAKED_PAIR_SECTION,0,au))}return true}}}}}}}return false};var h=function(aj){var am=0;for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){var al=ac(ak,aj);if(x[al]==0){am++}}return am};var R=function(al,aj){for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){var an=ac(ak,al);var am=ac(ak,aj);if((x[an]==0||x[am]==0)&&(x[an]!=0||x[am]!=0)){return false}}return true};var F=function(aj){if(ag){aj.print()}if(l){r.push(aj);J.push(aj)}};var s=function(){y(af,qqwing.BOARD_SIZE);y(a,qqwing.ROW_COL_SEC_SIZE)};var aa=function(aj){Y(ad.call(this,aj))};var ad=function(ak){var al="";for(var aj=0;aj<qqwing.BOARD_SIZE;aj++){if(U==qqwing.PrintStyle.READABLE){al+=" "}if(ak[aj]==0){al+="."}else{al+=ak[aj]}if(aj==qqwing.BOARD_SIZE-1){if(U==qqwing.PrintStyle.CSV){al+=","}else{al+="\n"}if(U==qqwing.PrintStyle.READABLE||U==qqwing.PrintStyle.COMPACT){al+="\n"}}else{if(aj%qqwing.ROW_COL_SEC_SIZE==qqwing.ROW_COL_SEC_SIZE-1){if(U==qqwing.PrintStyle.READABLE||U==qqwing.PrintStyle.COMPACT){al+="\n"}if(aj%qqwing.SEC_GROUP_SIZE==qqwing.SEC_GROUP_SIZE-1){if(U==qqwing.PrintStyle.READABLE){al+="-------|-------|-------\n"}}}else{if(aj%qqwing.GRID_SIZE==qqwing.GRID_SIZE-1){if(U==qqwing.PrintStyle.READABLE){al+=" |"}}}}}return al};var I=function(){for(var aj=2;aj<=z;aj+=2){O.call(this,aj)}};var G=function(){for(var aj=0;aj<qqwing.BOARD_SIZE;aj++){B[aj]=0}Q.call(this)};var b=function(aj){Y(ae(aj))};var ae=function(aj){var al="";if(!l){al+="History was not recorded.";if(U==qqwing.PrintStyle.CSV){al+=" -- "}else{al+="\n"}}for(var ak=0;ak<aj.length;ak++){al+=ak+1+". "+aj[ak].toString();if(U==qqwing.PrintStyle.CSV){al+=" -- "}else{al+="\n"}}if(U==qqwing.PrintStyle.CSV){al+=","}else{al+="\n"}return al};var L=function(al,aj,am){var ap=false;for(var ak=0;ak<qqwing.ROW_COL_SEC_SIZE;ak++){var ao=ac(ak,al);var an=ac(ak,aj);if(x[ao]==0&&x[an]==0){x[an]=am;ap=true}}return ap};var y=function(ao,al){for(var ak=0;ak<al;ak++){var am=al-ak;var an=Math.floor(Math.random()*am)+ak;var aj=ao[ak];ao[ak]=ao[an];ao[an]=aj}};var o=function(){var aj=Math.floor(Math.random()*4);switch(aj){case 0:return qqwing.Symmetry.ROTATE90;case 1:return qqwing.Symmetry.ROTATE180;case 2:return qqwing.Symmetry.MIRROR;case 3:return qqwing.Symmetry.FLIP}throw ("Unexpected random value: "+aj)};var u=function(aj,al){var am=0;for(var ak=0;ak<aj.length;ak++){if((aj[ak]).getType()==al){am++}}return am};this.LogItem=function(ao,am,al,aq){var ak=ao;var an=am;var ap=al;var aj=aq;this.getRound=function(){return ak};this.print=function(){N(this.toString())};this.getType=function(){return an};this.getColumn=function(){if(aj==-1){return -1}return ai(aj)};this.getRow=function(){if(aj==-1){return -1}return M(aj)};this.getPosition=function(){return aj};this.getValue=function(){return ap};this.getDescription=function(){switch(this.getType()){case qqwing.LogType.GIVEN:return"Mark given";case qqwing.LogType.ROLLBACK:return"Roll back round";case qqwing.LogType.GUESS:return"Mark guess (start round)";case qqwing.LogType.HIDDEN_SINGLE_ROW:return"Mark single possibility for value in row";case qqwing.LogType.HIDDEN_SINGLE_COLUMN:return"Mark single possibility for value in column";case qqwing.LogType.HIDDEN_SINGLE_SECTION:return"Mark single possibility for value in section";case qqwing.LogType.SINGLE:return"Mark only possibility for cell";case qqwing.LogType.NAKED_PAIR_ROW:return"Remove possibilities for naked pair in row";case qqwing.LogType.NAKED_PAIR_COLUMN:return"Remove possibilities for naked pair in column";case qqwing.LogType.NAKED_PAIR_SECTION:return"Remove possibilities for naked pair in section";case qqwing.LogType.POINTING_PAIR_TRIPLE_ROW:return"Remove possibilities for row because all values are in one section";case qqwing.LogType.POINTING_PAIR_TRIPLE_COLUMN:return"Remove possibilities for column because all values are in one section";case qqwing.LogType.ROW_BOX:return"Remove possibilities for section because all values are in one row";case qqwing.LogType.COLUMN_BOX:return"Remove possibilities for section because all values are in one column";case qqwing.LogType.HIDDEN_PAIR_ROW:return"Remove possibilities from hidden pair in row";case qqwing.LogType.HIDDEN_PAIR_COLUMN:return"Remove possibilities from hidden pair in column";case qqwing.LogType.HIDDEN_PAIR_SECTION:return"Remove possibilities from hidden pair in section";default:return"!!! Performed unknown optimization !!!"}};this.toString=function(){var ar="Round: "+this.getRound()+" - ";ar+=this.getDescription();if(ap>0||aj>-1){ar+=" (";var at=false;if(aj>-1){if(at){ar+=" - "}ar+="Row: "+(M(aj)+1)+" - Column: "+(ai(aj)+1);at=true}if(ap>0){if(at){ar+=" - "}ar+="Value: "+ap;at=true}ar+=")"}return ar}};this.setPuzzle=function(ak){for(var aj=0;aj<qqwing.BOARD_SIZE;aj++){B[aj]=ak[aj]}return Q.call(this)};this.printPuzzle=function(){return aa.call(this,B)};this.getPuzzleString=function(){return ad.call(this,B)};this.printSolution=function(){return aa.call(this,c)};this.getSolutionString=function(){return ad.call(this,c)};this.solve=function(aj){if(!aj||aj<=1){Q.call(this);s();return this.solve(2)}z=aj;while(D.call(this,aj)){if(this.isSolved()){return true}if(S.call(this)){return false}}var al=aj+1;var am=aj+2;for(var ak=0;A.call(this,al,ak);ak++){if(S.call(this)||!this.solve(am)){O.call(this,am);O.call(this,al)}else{return true}}return false};this.countSolutions=function(al,aq){if(!al||al<=1){var am=l;this.setRecordHistory(false);var ao=ag;this.setLogHistory(false);Q.call(this);var ak=this.countSolutions(2,false);this.setRecordHistory(am);this.setLogHistory(ao);return ak}else{while(D.call(this,al)){if(this.isSolved()){O.call(this,al);return 1}if(S.call(this)){O.call(this,al);return 0}}var aj=0;var ap=al+1;for(var an=0;A.call(this,ap,an);an++){aj+=this.countSolutions(ap,aq);if(aq&&aj>=2){O.call(this,al);return aj}}O.call(this,al);return aj}};this.isSolved=function(){for(var aj=0;aj<qqwing.BOARD_SIZE;aj++){if(c[aj]==0){return false}}return true};this.getSolveHistory=function(){if(this.isSolved()){return r}else{return"No solve history - Puzzle is not possible to solve."}};this.getSolveHistoryString=function(){if(this.isSolved()){return ae.call(this,r)}else{return"No solve history - Puzzle is not possible to solve."}};this.printSolveHistory=function(){if(this.isSolved()){b(r)}else{N("No solve history - Puzzle is not possible to solve.")}};this.setRecordHistory=function(aj){l=aj};this.setLogHistory=function(aj){ag=aj};this.setPrintStyle=function(aj){U=aj};this.generatePuzzle=function(){return this.generatePuzzleSymmetry(qqwing.Symmetry.NONE)};this.generatePuzzleSymmetry=function(av){if(av==qqwing.Symmetry.RANDOM){av=o.call(this)}var ak=l;this.setRecordHistory(false);var ar=ag;this.setLogHistory(false);G.call(this);s.call(this);this.solve();if(av==qqwing.Symmetry.NONE){I.call(this)}for(var ao=0;ao<qqwing.BOARD_SIZE;ao++){B[ao]=c[ao]}s.call(this);for(var ao=0;ao<qqwing.BOARD_SIZE;ao++){var ap=af[ao];if(B[ap]>0){var au=-1;var at=-1;var aq=-1;switch(av){case qqwing.Symmetry.ROTATE90:at=k(qqwing.ROW_COL_SEC_SIZE-1-ai(ap),M(ap));aq=k(ai(ap),qqwing.ROW_COL_SEC_SIZE-1-M(ap));case qqwing.Symmetry.ROTATE180:au=k(qqwing.ROW_COL_SEC_SIZE-1-M(ap),qqwing.ROW_COL_SEC_SIZE-1-ai(ap));break;case qqwing.Symmetry.MIRROR:au=k(M(ap),qqwing.ROW_COL_SEC_SIZE-1-ai(ap));break;case qqwing.Symmetry.FLIP:au=k(qqwing.ROW_COL_SEC_SIZE-1-M(ap),ai(ap));break}var aj=B[ap];B[ap]=0;var an=0;if(au>=0){an=B[au];B[au]=0}var am=0;if(at>=0){am=B[at];B[at]=0}var al=0;if(aq>=0){al=B[aq];B[aq]=0}Q.call(this);if(this.countSolutions(2,true)>1){B[ap]=aj;if(au>=0&&an!=0){B[au]=an}if(at>=0&&am!=0){B[at]=am}if(aq>=0&&al!=0){B[aq]=al}}}}Q.call(this);this.setRecordHistory(ak);this.setLogHistory(ar);return true};this.getGivenCount=function(){var ak=0;for(var aj=0;aj<qqwing.BOARD_SIZE;aj++){if(B[aj]!=0){ak++}}return ak};this.getSingleCount=function(){return u.call(this,J,qqwing.LogType.SINGLE)};this.getHiddenSingleCount=function(){return(u.call(this,J,qqwing.LogType.HIDDEN_SINGLE_ROW)+u.call(this,J,qqwing.LogType.HIDDEN_SINGLE_COLUMN)+u.call(this,J,qqwing.LogType.HIDDEN_SINGLE_SECTION))};this.getNakedPairCount=function(){return(u.call(this,J,qqwing.LogType.NAKED_PAIR_ROW)+u.call(this,J,qqwing.LogType.NAKED_PAIR_COLUMN)+u.call(this,J,qqwing.LogType.NAKED_PAIR_SECTION))};this.getHiddenPairCount=function(){return(u.call(this,J,qqwing.LogType.HIDDEN_PAIR_ROW)+u.call(this,J,qqwing.LogType.HIDDEN_PAIR_COLUMN)+u.call(this,J,qqwing.LogType.HIDDEN_PAIR_SECTION))};this.getBoxLineReductionCount=function(){return(u.call(this,J,qqwing.LogType.ROW_BOX)+u.call(this,J,qqwing.LogType.COLUMN_BOX))};this.getPointingPairTripleCount=function(){return(u.call(this,J,qqwing.LogType.POINTING_PAIR_TRIPLE_ROW)+u.call(this,J,qqwing.LogType.POINTING_PAIR_TRIPLE_COLUMN))};this.getGuessCount=function(){return u.call(this,J,qqwing.LogType.GUESS)};this.getBacktrackCount=function(){return u.call(this,r,qqwing.LogType.ROLLBACK)};this.getSolveInstructions=function(){if(this.isSolved()){return J}else{return"No solve instructions - Puzzle is not possible to solve."}};this.getSolveInstructionsString=function(){if(this.isSolved()){return ae.call(this,J)}else{return"No solve instructions - Puzzle is not possible to solve."}};this.printSolveInstructions=function(){if(this.isSolved()){b(J)}else{N("No solve instructions - Puzzle is not possible to solve.")}};this.getDifficulty=function(){if(this.getGuessCount()>0){return qqwing.Difficulty.EXPERT}if(this.getBoxLineReductionCount()>0){return qqwing.Difficulty.INTERMEDIATE}if(this.getPointingPairTripleCount()>0){return qqwing.Difficulty.INTERMEDIATE}if(this.getHiddenPairCount()>0){return qqwing.Difficulty.INTERMEDIATE}if(this.getNakedPairCount()>0){return qqwing.Difficulty.INTERMEDIATE}if(this.getHiddenSingleCount()>0){return qqwing.Difficulty.EASY}if(this.getSingleCount()>0){return qqwing.Difficulty.SIMPLE}return qqwing.Difficulty.UNKNOWN};this.getDifficultyAsString=function(){var aj=this.getDifficulty();switch(aj){case qqwing.Difficulty.EXPERT:return"Expert";case qqwing.Difficulty.INTERMEDIATE:return"Intermediate";case qqwing.Difficulty.EASY:return"Easy";case qqwing.Difficulty.SIMPLE:return"Simple";default:return"Unknown"}}};qqwing.PrintStyle={ONE_LINE:0,COMPACT:1,READABLE:2,CSV:3};qqwing.Difficulty={UNKNOWN:0,SIMPLE:1,EASY:2,INTERMEDIATE:3,EXPERT:4};qqwing.Symmetry={NONE:0,ROTATE90:1,ROTATE180:2,MIRROR:3,FLIP:4,RANDOM:5};qqwing.LogType={GIVEN:0,SINGLE:1,HIDDEN_SINGLE_ROW:2,HIDDEN_SINGLE_COLUMN:3,HIDDEN_SINGLE_SECTION:4,GUESS:5,ROLLBACK:6,NAKED_PAIR_ROW:7,NAKED_PAIR_COLUMN:8,NAKED_PAIR_SECTION:9,POINTING_PAIR_TRIPLE_ROW:10,POINTING_PAIR_TRIPLE_COLUMN:11,ROW_BOX:12,COLUMN_BOX:13,HIDDEN_PAIR_ROW:14,HIDDEN_PAIR_COLUMN:15,HIDDEN_PAIR_SECTION:16};qqwing.GRID_SIZE=3;qqwing.ROW_COL_SEC_SIZE=qqwing.GRID_SIZE*qqwing.GRID_SIZE;qqwing.SEC_GROUP_SIZE=qqwing.ROW_COL_SEC_SIZE*qqwing.GRID_SIZE;qqwing.BOARD_SIZE=qqwing.ROW_COL_SEC_SIZE*qqwing.ROW_COL_SEC_SIZE;qqwing.POSSIBILITY_SIZE=qqwing.BOARD_SIZE*qqwing.ROW_COL_SEC_SIZE;try{var applicationStartTime=getMicroseconds();var puzzleCount=0;var printPuzzle=false;var printSolution=false;var printHistory=false;var printInstructions=false;var timer=false;var countSolutions=false;var action="NONE";var logHistory=false;var printStyle=qqwing.PrintStyle.READABLE;var numberToGenerate=1;var printStats=false;var difficulty=qqwing.Difficulty.UNKNOWN;var symmetry=qqwing.Symmetry.NONE;var argv=process.argv;for(var i=2;i<argv.length;i++){if(argv[i]=="--puzzle"){printPuzzle=true}else{if(argv[i]=="--nopuzzle"){printPuzzle=false}else{if(argv[i]=="--solution"){printSolution=true}else{if(argv[i]=="--nosolution"){printSolution=false}else{if(argv[i]=="--history"){printHistory=true}else{if(argv[i]=="--nohistory"){printHistory=false}else{if(argv[i]=="--instructions"){printInstructions=true}else{if(argv[i]=="--noinstructions"){printInstructions=false}else{if(argv[i]=="--stats"){printStats=true}else{if(argv[i]=="--nostats"){printStats=false}else{if(argv[i]=="--timer"){timer=true}else{if(argv[i]=="--notimer"){timer=false}else{if(argv[i]=="--count-solutions"){countSolutions=true}else{if(argv[i]=="--nocount-solutions"){countSolutions=false}else{if(argv[i]=="--generate"){action="GENERATE";printPuzzle=true;if(i+1<argv.length&&argv[i+1].charAt(0)!="-"){numberToGenerate=parseInt(argv[i+1]);if(isNaN(numberToGenerate)||numberToGenerate<=0){console.log("Bad number of puzzles to generate: "+argv[i+1]);process.exit(1)}i++}}else{if(argv[i]=="--difficulty"){if(argv.length<=i+1){console.log("Please specify a difficulty.");process.exit(1)}else{if(argv[i+1].toLowerCase()=="simple"){difficulty=qqwing.Difficulty.SIMPLE}else{if(argv[i+1].toLowerCase()=="easy"){difficulty=qqwing.Difficulty.EASY}else{if(argv[i+1].toLowerCase()=="intermediate"){difficulty=qqwing.Difficulty.INTERMEDIATE}else{if(argv[i+1].toLowerCase()=="expert"){difficulty=qqwing.Difficulty.EXPERT}else{if(argv[i+1].toLowerCase()=="any"){difficulty=qqwing.Difficulty.UNKNOWN}else{console.log("Difficulty expected to be simple, easy, intermediate, expert, or any, not "+argv[i+1]);process.exit(1)}}}}}}i++}else{if(argv[i]=="--symmetry"){if(argv.length<=i+1){console.log("Please specify a symmetry.");process.exit(1)}else{if(argv[i+1]=="none"){symmetry=qqwing.Symmetry.NONE}else{if(argv[i+1]=="rotate90"){symmetry=qqwing.Symmetry.ROTATE90}else{if(argv[i+1]=="rotate180"){symmetry=qqwing.Symmetry.ROTATE180}else{if(argv[i+1]=="mirror"){symmetry=qqwing.Symmetry.MIRROR}else{if(argv[i+1]=="flip"){symmetry=qqwing.Symmetry.FLIP}else{if(argv[i+1]=="random"){symmetry=qqwing.Symmetry.RANDOM}else{console.log("Symmetry expected to be none, rotate90, rotate180, mirror, flip, or random, not "+argv[i+1]);process.exit(1)}}}}}}}i++}else{if(argv[i]=="--solve"){action="SOLVE";printSolution=true}else{if(argv[i]=="--log-history"){logHistory=true}else{if(argv[i]=="--nolog-history"){logHistory=false}else{if(argv[i]=="--one-line"){printStyle=qqwing.PrintStyle.ONE_LINE}else{if(argv[i]=="--compact"){printStyle=qqwing.PrintStyle.COMPACT}else{if(argv[i]=="--readable"){printStyle=qqwing.PrintStyle.READABLE}else{if(argv[i]=="--csv"){printStyle=qqwing.PrintStyle.CSV}else{if(argv[i]=="-n"||argv[i]=="--number"){if(i+1<argv.length){numberToGenerate=parseInt(argv[i+1]);i++}else{console.log("Please specify a number.");process.exit(1)}}else{if(argv[i]=="-h"||argv[i]=="--help"||argv[i]=="help"||argv[i]=="?"){printHelp();process.exit(0)}else{if(argv[i]=="--version"){printVersion();process.exit(0)}else{if(argv[i]=="--about"){printAbout();process.exit(0)}else{console.log("Unknown argument: '"+argv[i]+"'");printHelp();process.exit(0)}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(action=="NONE"){console.log("Either --solve or --generate must be specified.");printHelp();process.exit(1)}if(printStyle==qqwing.PrintStyle.CSV){if(printPuzzle){process.stdout.write("Puzzle,")}if(printSolution){process.stdout.write("Solution,")}if(printHistory){process.stdout.write("Solve History,")}if(printInstructions){process.stdout.write("Solve Instructions,")}if(countSolutions){process.stdout.write("Solution Count,")}if(timer){process.stdout.write("Time (milliseconds),")}if(printStats){process.stdout.write("Givens,Singles,Hidden Singles,Naked Pairs,Hidden Pairs,Pointing Pairs/Triples,Box/Line Intersections,Guesses,Backtracks,Difficulty")}console.log("")}var ss=new qqwing();ss.setRecordHistory(printHistory||printInstructions||printStats||difficulty!=qqwing.Difficulty.UNKNOWN);ss.setLogHistory(logHistory);ss.setPrintStyle(printStyle);var done=false;var numberGenerated=0;while(!done){var puzzleStartTime=getMicroseconds();var printedSomething=false;var havePuzzle=false;if(action=="GENERATE"){havePuzzle=ss.generatePuzzleSymmetry(symmetry);if(!havePuzzle&&printPuzzle){process.stdout.write("Could not generate puzzle.");if(printStyle==qqwing.PrintStyle.CSV){console.log(",")}else{console.log("")}printedSomething=true;process.exit(1)}}else{var puzzle=[];if(readPuzzleFromStdIn(puzzle)){havePuzzle=ss.setPuzzle(puzzle);if(!havePuzzle){if(printPuzzle){ss.printPuzzle();printedSomething=true}if(printSolution){process.stdout.write("Puzzle is not possible.");if(printStyle==qqwing.PrintStyle.CSV){process.stdout.write(",")}else{console.log("")}printedSomething=true}}}else{havePuzzle=false;done=true}puzzle=null}var solutions=0;if(havePuzzle){if(countSolutions){solutions=ss.countSolutions()}if(printSolution||printHistory||printStats||printInstructions||difficulty!=qqwing.Difficulty.UNKNOWN){ss.solve()}if(action=="GENERATE"){if(difficulty!=qqwing.Difficulty.UNKNOWN&&difficulty!=ss.getDifficulty()){havePuzzle=false}else{numberGenerated++;if(numberGenerated>=numberToGenerate){done=true}}}}if(havePuzzle){printedSomething=true;var puzzleDoneTime=getMicroseconds();if(printPuzzle){ss.printPuzzle()}if(printSolution){if(ss.isSolved()){ss.printSolution()}else{process.stdout.write("Puzzle has no solution.");if(printStyle==qqwing.PrintStyle.CSV){process.stdout.write(",")}else{console.log("")}}}if(printHistory){ss.printSolveHistory()}if(printInstructions){ss.printSolveInstructions()}if(countSolutions){if(printStyle==qqwing.PrintStyle.CSV){process.stdout.write(solutions+",")}else{if(solutions==0){console.log("There are no solutions to the puzzle.")}else{if(solutions==1){console.log("The solution to the puzzle is unique.")}else{console.log("There are "+solutions+" solutions to the puzzle.")}}}}if(timer){var t=(puzzleDoneTime-puzzleStartTime)/1000;if(printStyle==qqwing.PrintStyle.CSV){process.stdout.write(t+",")}else{console.log("Time: "+t+" milliseconds")}}if(printStats){var givenCount=ss.getGivenCount();var singleCount=ss.getSingleCount();var hiddenSingleCount=ss.getHiddenSingleCount();var nakedPairCount=ss.getNakedPairCount();var hiddenPairCount=ss.getHiddenPairCount();var pointingPairTripleCount=ss.getPointingPairTripleCount();var boxReductionCount=ss.getBoxLineReductionCount();var guessCount=ss.getGuessCount();var backtrackCount=ss.getBacktrackCount();var difficultyString=ss.getDifficultyAsString();if(printStyle==qqwing.PrintStyle.CSV){console.log(givenCount+","+singleCount+","+hiddenSingleCount+","+nakedPairCount+","+hiddenPairCount+","+pointingPairTripleCount+","+boxReductionCount+","+guessCount+","+backtrackCount+","+difficultyString+",")}else{console.log("Number of Givens: "+givenCount);console.log("Number of Singles: "+singleCount);console.log("Number of Hidden Singles: "+hiddenSingleCount);console.log("Number of Naked Pairs: "+nakedPairCount);console.log("Number of Hidden Pairs: "+hiddenPairCount);console.log("Number of Pointing Pairs/Triples: "+pointingPairTripleCount);console.log("Number of Box/Line Intersections: "+boxReductionCount);console.log("Number of Guesses: "+guessCount);console.log("Number of Backtracks: "+backtrackCount);console.log("Difficulty: "+difficultyString)}}puzzleCount++}if(printedSomething&&printStyle==qqwing.PrintStyle.CSV){console.log("")}}var applicationDoneTime=getMicroseconds();if(timer){var t=(applicationDoneTime-applicationStartTime)/1000000;console.log(puzzleCount+" puzzle"+((puzzleCount==1)?"":"s")+" "+(action=="GENERATE"?"generated":"solved")+" in "+t+" seconds.")}}catch(e){console.log(e.stack);process.exit(1)}process.exit(0);function printHelp(){console.log("qqwing <options>");console.log("Sudoku solver and generator.");console.log("  --generate <num>     Generate new puzzles");console.log("  --solve              Solve all the puzzles from standard input");console.log("  --difficulty <diff>  Generate only simple, easy, intermediate, expert, or any");console.log("  --symmetry <sym>     Symmetry: none, rotate90, rotate180, mirror, flip, or random");console.log("  --puzzle             Print the puzzle (default when generating)");console.log("  --nopuzzle           Do not print the puzzle (default when solving)");console.log("  --solution           Print the solution (default when solving)");console.log("  --nosolution         Do not print the solution (default when generating)");console.log("  --stats              Print statistics about moves used to solve the puzzle");console.log("  --nostats            Do not print statistics (default)");console.log("  --timer              Print time to generate or solve each puzzle");console.log("  --notimer            Do not print solve or generation times (default)");console.log("  --count-solutions    Count the number of solutions to puzzles");console.log("  --nocount-solutions  Do not count the number of solutions (default)");console.log("  --history            Print trial and error used when solving");console.log("  --nohistory          Do not print trial and error to solve (default)");console.log("  --instructions       Print the steps (at least 81) needed to solve the puzzle");console.log("  --noinstructions     Do not print steps to solve (default)");console.log("  --log-history        Print trial and error to solve as it happens");console.log("  --nolog-history      Do not print trial and error  to solve as it happens");console.log("  --one-line           Print puzzles on one line of 81 characters");console.log("  --compact            Print puzzles on 9 lines of 9 characters");console.log("  --readable           Print puzzles in human readable form (default)");console.log("  --csv                Output CSV format with one line puzzles");console.log("  --help               Print this message");console.log("  --about              Author and license information");console.log("  --version            Display current version number")}function printVersion(){console.log("qqwing 1.3.4")}function printAbout(){console.log("qqwing - Sudoku solver and generator");console.log("Copyright (C) 2014 Stephen Ostermiller");console.log("");console.log("This program is free software; you can redistribute it and/or modify");console.log("it under the terms of the GNU General Public License as published by");console.log("the Free Software Foundation; either version 2 of the License, or");console.log("(at your option) any later version.");console.log("");console.log("This program is distributed in the hope that it will be useful,");console.log("but WITHOUT ANY WARRANTY; without even the implied warranty of");console.log("MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the");console.log("GNU General Public License for more details.");console.log("");console.log("You should have received a copy of the GNU General Public License along");console.log("with this program; if not, write to the Free Software Foundation, Inc.,");console.log("51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.")}function getMicroseconds(){return new Date().getTime()*1000}function readPuzzleFromStdIn(b){var a=require("fs");var d=0;while(d<qqwing.BOARD_SIZE){var f=a.readSync(process.stdin.fd,1);if(f[1]==0){return false}if(f[0]>="1"&&f[0]<="9"){b[d]=f[0]-"0";d++}if(f[0]=="."||f[0]=="0"){b[d]=0;d++}}return true};